<!-- b_path:: .planning/phases/4.2-sidebar-implementation/4.2-CONTEXT.md -->
# Phase 4.2: Sidebar Implementation - Context

**Gathered:** 2026-01-15
**Status:** Ready for research

<vision>
## How This Should Work

Persistent sidebar (20% left) with navigation. Main area (80% right) shows ONE agent at a time. Other agents parked in hidden window, processes keep running. Click/keypress to switch agents.

Layout:
```
┌──────────┬─────────────────────────────────┐
│ SIDEBAR  │  MAIN (one agent at a time)     │
│ (20%)    │  (80%)                          │
│          │                                 │
│ [Nav]    │  [Active Agent]                 │
│ Agent 1● │                                 │
│ Agent 2  │                                 │
│ Agent 3  │                                 │
└──────────┴─────────────────────────────────┘
```

Must scale to 5+ agents.
</vision>

<essential>
## What Must Be Nailed

- Sidebar NEVER moves when switching agents
- Agent processes keep running when parked
- Switch is instant (no lag)
- Works reliably (no "can't find pane" errors)
</essential>

<boundaries>
## What's Out of Scope

- Mouse click navigation (keyboard first)
- Unread indicators (separate phase)
- Dynamic agent creation (start with fixed N agents)
</boundaries>

<prior_research>
## What We Learned (Session 2026-01-15)

**Working patterns verified:**
- `split-window -hb -l 20%` creates sidebar on LEFT
- `join-pane -h -s source -t target` moves pane
- `break-pane -d -s source` moves pane to new/existing window
- `resize-pane -x 24` fixes sizing after join
- `tmux set-option -g @key value` stores state

**Unsolved problems:**
- Pane index calculation during switch (indices shift after break)
- "index in use" errors when breaking back to hidden window
- Proper targeting syntax for multi-step operations

**POC location:** `TMP/sidebar-poc.sh` (v6, partially working)

**Research doc:** `.planning/phases/4.1-sidebar-navigation-ui/4.1-RESEARCH-v2.md`
</prior_research>

<notes>
## Additional Context

Previous attempts failed because:
1. Theoretical research without testing
2. Wrong pane targeting syntax
3. Not understanding how pane indices shift

This phase should focus on getting a WORKING POC first, then integrating into Nancy.

Key insight from tmux-sidebar: use tmux options for state, use pane IDs (not indices) for stable targeting.
</notes>

---

*Phase: 4.2-sidebar-implementation*
*Context gathered: 2026-01-15*
